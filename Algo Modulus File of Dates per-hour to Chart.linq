<Query Kind="Program" />

void Main()
{
	//var dates = System.IO.File.ReadAllLines(@"C:\datetime.txt")
	//	.Select(d => DateTime.Parse(d).Date.AddHours(DateTime.Parse(d).Hour)).Where(d => d > DateTime.Parse("2019-03-25") );

	var dates = ExampleData()
		.Select(d => DateTime.Parse(d).Date.AddHours(DateTime.Parse(d).Hour));

	var epoch = dates.Min().Date;
	var groupingCount = 1;
	
	var maxDateTimeHours = (int)(dates.Max()-epoch).TotalHours+groupingCount;
	
	var baseGroup = Enumerable.Range(0,maxDateTimeHours)
						.Select(e => epoch.AddHours(e) )
						.GroupBy(d => d.AddHours(-(d - epoch).Hours % groupingCount))
						.OrderBy(o => o.Key);
						
	var dateGroup = dates.GroupBy(d => d.AddHours(-(d - epoch).Hours % groupingCount))
						.OrderBy(o => o.Key);
	
	var reportResult = (from baseItm in baseGroup
	 join date in dateGroup on baseItm.Key equals date.Key into joinSet
	 from result in joinSet.DefaultIfEmpty()
	 select new { range = baseItm.Key, count= result?.Count()??0}
	);

	reportResult.Dump();
	reportResult.Chart(r => r.range.ToString("s"), v => v.count).Dump();
	reportResult.Average(r => r.count ).Dump("Total per Hour");

}

// Define other methods and classes here
private List<string> ExampleData()
{
	return
	@"01/04/2020 08:05:36 AM
01/04/2020 06:48:35 AM
01/01/2020 09:35:07 PM
01/04/2020 12:45:57 PM
01/06/2020 12:24:30 PM
01/05/2020 04:24:17 PM
01/01/2020 07:34:01 AM
01/03/2020 05:39:17 AM
01/06/2020 12:59:11 AM
01/04/2020 09:27:36 AM
01/06/2020 08:01:26 PM
01/02/2020 04:39:38 PM
01/05/2020 06:34:22 PM
01/01/2020 12:22:30 AM
01/01/2020 04:21:06 PM
01/04/2020 07:14:45 PM
01/02/2020 08:37:52 AM
01/02/2020 08:29:15 AM
01/02/2020 08:16:01 AM
01/05/2020 10:45:07 AM
01/04/2020 10:17:39 PM
01/02/2020 04:26:08 AM
01/04/2020 08:02:08 PM
01/04/2020 03:58:40 PM
01/06/2020 05:45:34 PM
01/06/2020 01:07:06 AM
01/04/2020 05:11:16 PM
01/04/2020 09:47:38 PM
01/02/2020 01:44:25 AM
01/05/2020 08:17:18 AM
01/03/2020 05:05:22 AM
01/01/2020 10:36:53 AM
01/06/2020 02:26:59 PM
01/06/2020 03:39:47 PM
01/03/2020 11:17:35 AM
01/03/2020 08:16:55 AM
01/03/2020 07:25:08 AM
01/04/2020 04:51:30 PM
01/02/2020 03:06:01 AM
01/05/2020 07:43:41 PM
01/06/2020 08:38:07 AM
01/01/2020 10:19:42 AM
01/05/2020 06:51:35 AM
01/05/2020 08:20:16 PM
01/06/2020 03:31:19 PM
01/01/2020 05:11:56 AM
01/05/2020 02:19:25 PM
01/06/2020 07:41:14 PM
01/05/2020 12:15:48 PM
01/06/2020 08:47:41 AM
01/06/2020 03:04:20 AM
01/02/2020 01:16:56 PM
01/03/2020 07:54:13 AM
01/03/2020 07:29:07 AM
01/06/2020 12:15:07 PM
01/03/2020 01:17:17 AM
01/02/2020 10:13:22 AM
01/04/2020 09:16:20 PM
01/01/2020 04:40:32 AM
01/02/2020 03:22:30 PM
01/02/2020 12:45:35 AM
01/01/2020 11:50:38 PM
01/05/2020 05:38:03 PM
01/06/2020 06:49:30 PM
01/03/2020 09:49:25 PM
01/02/2020 01:37:24 AM
01/02/2020 03:51:19 PM
01/04/2020 06:15:24 AM
01/06/2020 08:13:13 AM
01/03/2020 09:48:52 PM
01/02/2020 04:20:33 PM
01/02/2020 09:32:50 PM
01/05/2020 05:42:28 PM
01/04/2020 03:35:55 PM
01/01/2020 01:15:40 AM
01/03/2020 06:22:45 AM
01/06/2020 09:04:02 PM
01/04/2020 04:15:19 AM
01/06/2020 07:35:11 PM
01/01/2020 04:42:38 AM
01/04/2020 08:02:29 AM
01/04/2020 11:31:54 PM
01/02/2020 06:09:13 AM
01/04/2020 02:02:00 PM
01/02/2020 06:01:46 AM
01/06/2020 04:21:47 PM
01/04/2020 07:42:09 PM
01/05/2020 01:30:42 PM
01/05/2020 11:00:27 AM
01/06/2020 01:39:02 AM
01/01/2020 07:31:22 AM
01/06/2020 04:01:20 PM
01/02/2020 08:17:03 PM
01/03/2020 05:42:40 PM
01/06/2020 08:20:43 AM
01/05/2020 01:56:10 PM
01/02/2020 02:04:02 AM
01/03/2020 12:25:01 PM
01/06/2020 02:45:28 PM
01/04/2020 02:45:32 AM
01/04/2020 11:08:32 AM
01/04/2020 12:30:08 PM
01/05/2020 02:20:55 PM
01/02/2020 02:02:40 PM
01/03/2020 09:34:54 PM
01/01/2020 07:13:45 AM
01/01/2020 03:16:54 AM
01/05/2020 10:34:31 AM
01/01/2020 08:47:47 AM
01/01/2020 01:39:33 AM
01/03/2020 06:45:30 AM
01/03/2020 02:13:09 AM
01/04/2020 05:29:06 PM
01/04/2020 02:51:53 PM
01/03/2020 11:44:27 AM
01/05/2020 06:07:22 AM
01/03/2020 11:36:49 AM
01/03/2020 10:12:01 AM
01/02/2020 02:28:58 PM
01/01/2020 02:15:45 AM
01/05/2020 06:12:01 PM
01/02/2020 10:18:30 AM
01/04/2020 08:34:03 PM
01/06/2020 01:48:46 PM
01/04/2020 12:20:14 AM
01/02/2020 06:40:57 AM
01/06/2020 01:49:52 AM
01/03/2020 03:29:23 PM
01/01/2020 12:23:55 PM
01/02/2020 10:39:32 PM
01/02/2020 02:38:45 AM
01/03/2020 08:29:28 AM
01/03/2020 04:40:28 AM
01/03/2020 11:20:57 PM
01/04/2020 12:27:32 AM
01/06/2020 05:40:29 PM
01/04/2020 09:19:15 PM
01/06/2020 09:30:19 AM
01/02/2020 02:51:24 AM
01/01/2020 04:10:14 AM
01/01/2020 12:59:07 PM
01/02/2020 09:18:23 AM
01/02/2020 08:51:10 AM
01/06/2020 10:46:14 PM
01/04/2020 08:11:19 PM
01/05/2020 06:38:33 PM
01/05/2020 10:35:33 AM
01/03/2020 01:41:54 PM
01/05/2020 03:29:59 PM
01/05/2020 08:21:00 AM
01/01/2020 11:18:49 PM
01/05/2020 10:56:48 AM
01/03/2020 03:39:59 AM
01/06/2020 04:57:09 AM
01/02/2020 01:28:22 AM
01/01/2020 05:05:44 PM
01/01/2020 11:38:19 PM
01/01/2020 08:27:32 PM
01/06/2020 04:50:55 PM
01/01/2020 11:52:18 AM
01/01/2020 04:37:13 AM
01/02/2020 07:53:21 PM
01/06/2020 09:36:34 AM
01/05/2020 04:29:20 PM
01/06/2020 04:29:32 PM
01/02/2020 11:10:54 AM
01/06/2020 06:10:22 AM
01/05/2020 11:23:11 PM
01/01/2020 01:08:42 PM
01/02/2020 09:42:06 AM
01/01/2020 06:28:41 PM
01/05/2020 02:54:38 AM
01/03/2020 03:54:30 AM
01/02/2020 11:18:23 PM
01/01/2020 09:24:28 PM
01/03/2020 08:31:17 AM
01/01/2020 02:41:46 PM
01/03/2020 11:42:06 AM
01/03/2020 03:30:02 AM
01/02/2020 08:15:31 AM
01/02/2020 01:54:08 AM
01/02/2020 11:29:43 AM
01/02/2020 07:49:07 AM
01/01/2020 07:20:33 AM
01/05/2020 10:55:35 AM
01/04/2020 08:37:37 AM
01/01/2020 08:46:21 PM
01/04/2020 03:08:11 AM
01/06/2020 01:50:09 PM
01/06/2020 09:54:42 AM
01/01/2020 11:58:59 AM
01/03/2020 12:29:37 PM
01/03/2020 04:12:36 AM
01/02/2020 05:10:30 AM
01/05/2020 08:30:31 AM
01/04/2020 05:55:57 AM
01/04/2020 10:37:22 AM
01/06/2020 08:22:06 PM
01/04/2020 08:55:40 PM
01/05/2020 03:06:21 AM
01/02/2020 09:58:29 AM
01/01/2020 02:25:01 AM
01/02/2020 02:11:34 AM
01/02/2020 07:59:18 AM
01/03/2020 10:32:39 PM
01/06/2020 12:32:59 AM
01/01/2020 06:40:38 PM
01/06/2020 11:31:57 PM
01/01/2020 03:25:06 PM
01/04/2020 03:24:17 PM
01/03/2020 08:56:38 PM
01/06/2020 01:41:35 AM
01/01/2020 12:02:31 PM
01/03/2020 10:51:23 PM
01/04/2020 12:54:01 AM
01/01/2020 05:23:21 PM
01/01/2020 06:45:33 AM
01/03/2020 07:25:02 AM
01/04/2020 09:36:48 PM
01/02/2020 04:47:03 AM
01/05/2020 11:52:43 AM
01/04/2020 04:18:05 AM
01/04/2020 01:00:19 PM
01/01/2020 04:48:09 AM
01/05/2020 01:24:35 PM
01/06/2020 10:27:01 PM
01/01/2020 05:39:32 PM
01/04/2020 03:54:32 AM
01/05/2020 07:11:55 PM
01/04/2020 03:08:08 AM
01/01/2020 08:23:06 PM
01/05/2020 07:24:01 PM
01/06/2020 12:55:05 PM
01/05/2020 02:55:02 AM
01/03/2020 06:49:55 PM
01/03/2020 07:22:34 AM
01/06/2020 12:08:32 AM
01/01/2020 04:43:57 PM
01/01/2020 12:00:03 AM
01/01/2020 04:46:34 AM
01/03/2020 07:24:37 AM
01/01/2020 03:40:25 AM
01/05/2020 02:41:52 PM
01/01/2020 11:32:54 PM
01/02/2020 11:10:29 PM
01/04/2020 05:33:21 PM
01/01/2020 07:01:51 AM
01/06/2020 08:44:24 AM
01/02/2020 03:17:08 PM
01/06/2020 10:30:15 AM
01/06/2020 07:40:03 AM
01/06/2020 01:35:08 PM
01/02/2020 04:35:06 PM
01/01/2020 09:35:56 AM
01/06/2020 10:43:17 AM
01/02/2020 06:00:51 PM
01/05/2020 10:45:53 AM
01/04/2020 01:20:18 PM
01/05/2020 03:50:34 AM
01/02/2020 10:14:33 AM
01/02/2020 06:03:23 PM
01/06/2020 01:48:58 AM
01/01/2020 02:01:50 AM
01/01/2020 10:40:45 AM
01/02/2020 05:30:30 AM
01/02/2020 10:42:03 PM
01/04/2020 06:03:03 PM
01/05/2020 10:51:19 AM
01/02/2020 08:48:20 AM
01/05/2020 02:22:16 AM
01/01/2020 12:08:03 PM
01/06/2020 11:45:28 AM
01/02/2020 04:51:55 AM
01/05/2020 10:13:35 PM
01/02/2020 01:59:36 AM
01/01/2020 09:53:08 PM
01/04/2020 11:40:42 AM
01/05/2020 02:27:28 PM
01/01/2020 11:39:04 PM
01/06/2020 05:09:19 PM
01/05/2020 11:20:38 PM
01/01/2020 02:32:18 AM
01/02/2020 01:11:04 PM
01/03/2020 03:32:06 AM
01/04/2020 09:16:25 AM
01/03/2020 05:35:32 AM
01/01/2020 06:24:16 AM
01/05/2020 02:25:51 PM
01/05/2020 02:02:26 PM
01/04/2020 04:08:59 PM
01/01/2020 09:39:07 AM
01/03/2020 05:43:37 PM
01/06/2020 11:22:05 PM
01/06/2020 12:38:36 PM
01/03/2020 10:42:47 AM
01/06/2020 08:49:08 AM
01/03/2020 12:11:21 PM
01/06/2020 06:37:41 PM
01/06/2020 06:16:33 AM
01/06/2020 06:20:02 AM
01/01/2020 05:58:03 PM
01/06/2020 11:28:01 AM
01/04/2020 06:41:00 AM
01/05/2020 08:18:59 AM
01/06/2020 03:45:00 AM
01/01/2020 01:20:15 AM
01/05/2020 02:25:10 PM
01/06/2020 10:10:15 PM
01/02/2020 10:33:28 PM
01/03/2020 05:14:17 PM
01/05/2020 11:28:40 AM
01/01/2020 02:16:19 AM
01/06/2020 07:06:35 PM
01/02/2020 11:04:23 AM
01/04/2020 07:14:37 AM
01/05/2020 10:22:05 AM
01/02/2020 11:00:41 PM
01/03/2020 02:22:08 PM
01/03/2020 09:57:08 AM
01/03/2020 08:13:43 PM
01/03/2020 01:01:24 AM
01/05/2020 12:26:03 AM
01/04/2020 11:54:15 PM
01/05/2020 06:30:53 PM
01/02/2020 06:50:20 AM
01/06/2020 11:35:07 AM
01/01/2020 06:34:33 AM
01/06/2020 04:45:17 PM
01/03/2020 07:13:21 AM
01/01/2020 10:12:25 AM
01/06/2020 01:41:58 AM
01/02/2020 04:29:18 AM
01/02/2020 01:27:06 PM
01/03/2020 04:34:23 PM
01/05/2020 09:04:29 PM
01/02/2020 10:13:14 AM
01/05/2020 07:30:39 PM
01/04/2020 03:26:10 PM
01/03/2020 08:09:08 PM
01/01/2020 12:59:48 PM
01/05/2020 10:06:57 PM
01/05/2020 12:32:47 PM
01/01/2020 02:16:32 PM
01/06/2020 09:01:17 AM
01/05/2020 06:56:28 AM
01/05/2020 04:47:41 AM
01/04/2020 06:22:08 PM
01/03/2020 04:45:48 PM
01/03/2020 10:38:42 PM
01/02/2020 09:49:24 AM
01/05/2020 05:51:38 AM
01/06/2020 09:57:54 AM
01/01/2020 09:24:37 PM
01/02/2020 04:24:29 PM
01/05/2020 10:39:21 AM
01/01/2020 09:07:08 AM
01/05/2020 08:01:51 PM
01/06/2020 01:11:13 PM
01/05/2020 05:20:01 AM
01/01/2020 06:08:22 PM
01/02/2020 04:37:29 PM
01/06/2020 01:05:13 AM
01/01/2020 04:18:10 AM
01/05/2020 04:20:16 AM
01/04/2020 06:48:47 PM
01/04/2020 08:04:33 PM
01/05/2020 04:58:51 PM
01/05/2020 03:26:36 AM
01/01/2020 02:58:15 AM
01/05/2020 08:10:23 AM
01/06/2020 01:51:29 PM
01/05/2020 01:02:14 AM
01/06/2020 08:32:34 PM
01/06/2020 01:09:08 AM
01/05/2020 10:12:07 AM
01/06/2020 09:06:40 AM
01/01/2020 08:45:43 AM
01/04/2020 11:39:24 PM
01/06/2020 04:37:04 AM
01/04/2020 01:53:55 PM
01/02/2020 09:58:42 PM
01/04/2020 12:28:04 PM
01/06/2020 09:03:54 PM
01/04/2020 05:11:09 PM
01/01/2020 05:54:06 AM
01/01/2020 10:50:31 AM
01/05/2020 09:54:17 PM
01/03/2020 03:26:37 PM
01/04/2020 05:40:28 AM
01/03/2020 06:32:38 PM
01/04/2020 03:19:24 AM
01/03/2020 07:47:50 PM
01/06/2020 10:03:27 PM
01/03/2020 12:31:05 AM
01/02/2020 04:22:31 AM
01/05/2020 01:50:50 PM
01/04/2020 11:03:30 AM
01/04/2020 03:34:38 AM
01/03/2020 08:46:09 AM
01/03/2020 12:19:40 PM
01/03/2020 06:34:13 PM
01/05/2020 12:04:03 AM
01/05/2020 01:41:00 PM
01/01/2020 08:50:11 AM
01/05/2020 04:40:18 PM
01/06/2020 03:44:43 PM
01/06/2020 12:14:52 PM
01/02/2020 12:22:45 AM
01/01/2020 07:37:30 AM
01/01/2020 02:57:48 AM
01/01/2020 03:43:33 AM
01/01/2020 09:48:09 PM
01/04/2020 09:58:24 AM
01/02/2020 05:02:09 AM
01/06/2020 01:16:18 PM
01/01/2020 08:39:56 AM
01/02/2020 02:16:04 AM
01/06/2020 09:18:12 PM
01/06/2020 05:36:49 AM
01/02/2020 10:19:22 AM
01/04/2020 10:02:11 AM
01/02/2020 04:32:21 AM
01/04/2020 11:25:54 AM
01/06/2020 10:07:36 PM
01/05/2020 02:37:04 PM
01/04/2020 03:14:41 PM
01/04/2020 11:30:27 PM
01/03/2020 07:25:34 AM
01/05/2020 12:53:45 PM
01/06/2020 10:14:14 AM
01/01/2020 07:11:35 AM
01/02/2020 03:07:19 AM
01/03/2020 02:46:16 PM
01/01/2020 10:00:00 AM
01/05/2020 04:57:35 AM
01/05/2020 04:17:27 AM
01/02/2020 11:59:21 AM
01/05/2020 02:56:18 PM
01/02/2020 05:39:17 AM
01/04/2020 08:14:44 PM
01/06/2020 03:43:57 PM
01/06/2020 10:23:07 AM
01/06/2020 12:09:02 AM
01/06/2020 02:26:47 PM
01/06/2020 08:31:48 PM
01/04/2020 03:05:10 PM
01/03/2020 07:47:10 PM
01/01/2020 09:46:12 AM
01/03/2020 05:38:07 AM
01/02/2020 01:48:21 AM
01/06/2020 09:41:28 AM
01/01/2020 10:03:27 PM
01/06/2020 11:58:50 PM
01/05/2020 07:30:47 PM
01/04/2020 12:15:10 AM
01/03/2020 01:08:46 AM
01/06/2020 08:40:10 AM
01/02/2020 02:44:59 AM
01/06/2020 06:25:52 AM
01/01/2020 01:09:57 PM
01/04/2020 09:18:53 PM
01/05/2020 05:17:59 AM
01/06/2020 12:54:28 PM
01/01/2020 09:32:10 PM
01/05/2020 10:20:26 PM
01/02/2020 01:03:06 PM
01/01/2020 11:40:54 PM
01/05/2020 12:06:54 AM
01/04/2020 08:17:24 PM
01/05/2020 06:47:04 PM
01/06/2020 06:49:25 PM
01/03/2020 09:15:46 AM
01/04/2020 08:47:29 AM
01/05/2020 03:58:55 AM
01/06/2020 10:36:36 PM
01/01/2020 10:34:35 PM
01/03/2020 09:02:13 AM
01/03/2020 12:50:21 PM
01/04/2020 07:09:25 AM
01/05/2020 01:24:46 AM
01/03/2020 09:01:50 PM
01/03/2020 10:54:08 PM
01/02/2020 04:40:22 PM
01/02/2020 01:28:02 AM
01/05/2020 12:18:56 AM
01/04/2020 02:18:48 AM
01/01/2020 06:40:47 PM
01/06/2020 01:07:02 AM
01/01/2020 01:09:59 PM
01/03/2020 07:39:52 PM
01/05/2020 11:19:35 PM
01/05/2020 06:26:50 AM
01/03/2020 06:11:55 AM
01/05/2020 01:46:57 PM
01/05/2020 04:02:12 AM
01/01/2020 11:55:53 AM
01/05/2020 10:00:24 AM
01/05/2020 06:39:37 PM
01/06/2020 05:37:52 AM
01/03/2020 12:16:52 PM".Split('\n').ToList();
}